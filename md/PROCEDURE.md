## 分析手順

データは異なる年度間で共通受検者と共通項目が存在する。共通受検者は政治家調査のみに存在するが，長期間にわたって自身の潜在的特性が変化しないとは想定しにくいので，今回は年度間の受検者を独立に扱う。また，推定には多母集団推定を用いる。有権者調査の連続する二回の調査は同一個人を対象に実施しているが，こちらもやはり潜在的特性が変化していないとは想定しにくいため，独立に扱う方が良い。 　
後半ではより発展的に，固体および項目の繰り返し測定におけるばらつきもモデリングしたいと考えている。

### 項目分析
全調査をマージした冊子を用いて，項目ごとにトレースプロットを描画する。ただし年度ごとにテスト冊子が異なるので，項目 $\times$ 冊子の形で分析し，項目ごとおよび冊子ごとに項目分析を実行する必要がある。縦軸には各選択肢の選択割合をとり，横軸にはテストの合計得点をとる。  
IT相関を計算し，項目ごとの古典的な識別力を算出する。  
IT相関の値が負になる項目はおそらく逆転処理(Reverse Coding)が必要な項目であるから、当該項目だけ逆転処理を施す。

### 一次元性の確認
冊子ごとにスクリープロットを描画し，一次元のIRTモデルが適用可能かを確認する。

### IRT分析
いくつかの推定方法、モデルを当てはめる必要がある。推定のためにはRのパッケージである[mirt](https://github.com/philchalmers/mirt/wiki)とStanを使用する。

*モデル*  
mirtでは以下のモデルの分析が可能である。[manual](https://cran.r-project.org/web/packages/mirt/mirt.pdf)  

- 段階反応モデル(Samejima, 1969)
- 名義反応モデル(Bock, 1972)
- ~~Ideal Poind Model(Maydeu-Olivares, 2006)~~
- ~~generalized graded unfolding model (Roberts, Donoghue, & Laughlin, 2000)~~
- Extended Mixed-Effect IRT (個人差および測定間のばらつきを扱うモデル)
- Longitudinal IRT Model(???)
- MIRT model
- Multidimensional discrete item response theory(DINA?)

データを十分に吟味する必要はあるが、とりあえず全てのモデルを試す予定である。

Stanでは階層性を組み込んだモデルを検討する予定である。  

- Hierarchical Bayesian IRT

Stanで多母集団を推定する場合は、階層型のモデルを応用すれば可能であるが、いずれリポジトリにも公開する予定である。

##### 推定の設定と収束基準について
項目パラメタには以下の事前分布を設定する。 ~~識別力は$log N ~(0, 1)$、困難度は$N ~ (0,1)$を用いる。~~ 
 mirtの分析はEMサイクルの最大回数を500回に設定する（これ以上多くしても対数尤度は大きく変化しないため。最終版の推定値を出す際はもっと反復回数を多くした方がよい）。収束基準はデフォルトの`TOL = 3e-5`とする。
